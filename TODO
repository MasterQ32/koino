* use errdefer, actually recover without loss
* clean up allocator use/passing around/etc.
